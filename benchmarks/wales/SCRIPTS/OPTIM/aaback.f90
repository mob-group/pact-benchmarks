PROGRAM AABACK
IMPLICIT NONE
CHARACTER(LEN=4) DSTRING,ASTRING
CHARACTER(LEN=3) RES
INTEGER NAT, J1

OPEN(UNIT=7,FILE='aabk',STATUS='UNKNOWN')

DO 

   READ(*,'(A4,1X,I6,1X,A4,1X,A3)',END=666) DSTRING,NAT,ASTRING,RES

   WRITE(*,'(A3)') ASTRING(2:4)

   IF ((ASTRING(2:4).EQ.'N  ').OR. &
  &    (ASTRING(2:4).EQ.'H  ').OR. &
  &    (ASTRING(2:4).EQ.'CA ').OR. &
  &    (ASTRING(2:4).EQ.'HA ').OR. &
  &    (ASTRING(2:4).EQ.'CB ').OR. &
  &    (ASTRING(2:4).EQ.'C  ').OR. &
  &    (ASTRING(2:4).EQ.'O  ').OR. &
  &    (ASTRING(2:4).EQ.'HA2').OR. &
  &    (ASTRING(2:4).EQ.'HA3')) THEN

      WRITE(7,'(I8)') NAT

   ENDIF

ENDDO

666 CONTINUE

CLOSE(7)

END PROGRAM AABACK
